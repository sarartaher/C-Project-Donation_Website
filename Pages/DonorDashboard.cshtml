@page
@model Donation_Website.Pages.DonorDashboardModel
@{
    ViewData["Title"] = "Donor Dashboard";
    var userName = Model.HttpContext.Session.GetString("UserName");
    var events = new List<dynamic>
 {
 new { Name = "Education Fundraiser", EndTime = DateTime.Now.AddHours(5),
StartTime = DateTime.Now },
 new { Name = "Health Campaign", EndTime = DateTime.Now.AddHours(10), StartTime =
DateTime.Now },
 new { Name = "Disaster Relief", EndTime = DateTime.Now.AddDays(1), StartTime =
DateTime.Now }
 };
}
<section class="p-5">
    <!-- Header -->
    <header class="bg-white shadow-sm p-4 rounded-3 mb-4 text-center">
        <h1 class="h3 fw-bold text-dark mb-0">Donor Dashboard</h1>
        <div class="gap-3">
            <span class="text-muted text-center display-6">
                Hello,
                <strong>@userName</strong>
            </span>
        </div>
    </header>
    <!-- Timer Section -->
    <div class="bg-white shadow-sm rounded-3 p-4 mb-5">
        <h2 class="h4 fw-semibold text-dark mb-3">Ongoing Events Countdown</h2>
        @foreach (var ev in events)
        {
            <div class="mb-3">
                <div class="d-flex justify-content-between">
                    <span class="fw-bold">@ev.Name</span>
                    <span id="timer-@ev.Name.Replace(" ", "")">Loading...</span>
                </div>
                <div class="progress" style="height: 20px;">
                    <div id="green-@ev.Name.Replace(" ", "")" class="progress-bar bg-success"
                         role="progressbar" style="width: 100%"></div>
                    <div id="red-@ev.Name.Replace(" ", "")" class="progress-bar bg-danger"
                         role="progressbar" style="width: 0%"></div>
                </div>
            </div>
        }
    </div>
    <!-- System Overview -->
    <div class="bg-white shadow-sm rounded-3 p-4 mb-5">
        <h2 class="h4 fw-semibold text-dark mb-3">System Overview</h2>
        <p class="text-muted lh-base">
            From here, you can make donations, view your donation history, manage receipts,
            track funded projects, and share reviews on completed works.
        </p>
    </div>
    <!-- Feature Grid -->
    <div class="row g-4">
        <!-- Make a Donation -->
        <div class="col-12 col-md-6 col-xl-4">
            <div class="card h-100 border-0" style="background-color: #dbeafe;">
                <div class="card-body d-flex flex-column text-center">
                    <h5 class="card-title">Make a Donation</h5>
                    <p class="card-text text-dark">Securely donate to projects and fundraisers.</p>
                    <div class="mt-auto">
                        <button class="btn btn-primary"
                                onclick="location.href='@Url.Page("/Donation")'">
                            Donate
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <!-- Donation History -->
        <div class="col-12 col-md-6 col-xl-4">
            <div class="card h-100 border-0" style="background-color: #fef3c7;">
                <div class="card-body d-flex flex-column text-center">
                    <h5 class="card-title">Donation History</h5>
                    <p class="card-text text-dark">
                        View all your donations with amounts, dates, and
                        statuses.
                    </p>
                    <div class="mt-auto">
                        <button class="btn btn-warning"
                                onclick="location.href='@Url.Page("/DonationHistory")'">
                            History
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <!-- Donation Progress -->
        <div class="col-12 col-md-6 col-xl-4">
            <div class="card h-100 border-0" style="background-color: #dcfce7;">
                <div class="card-body d-flex flex-column text-center">
                    <h5 class="card-title">Donation Progress</h5>
                    <p class="card-text text-dark">
                        Track the progress of projects you have
                        contributed to.
                    </p>
                    <div class="mt-auto">
                        <button class="btn btn-success"
                                onclick="location.href='@Url.Page("/DonorProgress")'">
                            View Progress
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <!-- Donor Remarkable Position -->
        <div class="col-12 col-md-6 col-xl-4">
            <div class="card h-100 border-0" style="background-color: #fde68a;">
                <div class="card-body d-flex flex-column text-center">
                    <h5 class="card-title">Donor Remarkable Position</h5>
                    <p class="card-text text-dark">
                        See where you stand among other donors and
                        your special recognition.
                    </p>
                    <div class="mt-auto">
                        <button class="btn btn-dark"
                                onclick="location.href='@Url.Page("/DonorRemarkPosition")'">
                            Check Position
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <!-- Donor Profile -->
        <div class="col-12 col-md-6 col-xl-4">
            <div class="card h-100 border-0" style="background-color: #e0f2fe;">
                <div class="card-body d-flex flex-column text-center">
                    <h5 class="card-title">Donor Profile</h5>
                    <p class="card-text text-dark">
                        Update your personal details, preferences, and
                        account settings.
                    </p>
                    <div class="mt-auto">
                        <button class="btn btn-info"
                                onclick="location.href='@Url.Page("/DonorProfile")'">
                            View Profile
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <!-- Donor Package -->
        <div class="col-12 col-md-6 col-xl-4">
            <div class="card h-100 border-0" style="background-color: #f0abfc;">
                <div class="card-body d-flex flex-column text-center">
                    <h5 class="card-title">Donor Package</h5>
                    <p class="card-text text-dark">
                        Explore exclusive donor packages, benefits, and subscription options.
                    </p>
                    <div class="mt-auto">
                        <button class="btn btn-secondary"
                                onclick="location.href='@Url.Page("/DonorPakage")'">
                            View Packages
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<script>
     const events = [
     @foreach (var ev in events)
     {
         @: { name: "@ev.Name", startTime: new Date("@ev.StartTime.ToString("yyyyMM-ddTHH:mm:ss")"), endTime: new Date("@ev.EndTime.ToString("yyyy-MMddTHH:mm:ss")") },
     }
     ];
     function updateTimers() {
     const now = new Date();
     events.forEach(ev => {
     const timerId = "timer-" + ev.name.replace(/\s/g, "");
     const greenId = "green-" + ev.name.replace(/\s/g, "");
     const redId = "red-" + ev.name.replace(/\s/g, "");
     const totalDuration = ev.endTime - ev.startTime;
     const timeLeft = ev.endTime - now;
     if (timeLeft <= 0) {
     document.getElementById(timerId).innerText = "Event Ended";
     document.getElementById(greenId).style.width = "0%";
     document.getElementById(redId).style.width = "100%";
     return;
     }
     // Countdown calculation
     const hours = Math.floor(timeLeft / (1000 * 60 * 60));
     const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
     const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
     document.getElementById(timerId).innerText = `${hours}h ${minutes}m
    ${seconds}s`;
     // Progress bars calculation
     const greenPercent = (timeLeft / totalDuration) * 100;
     const redPercent = 100 - greenPercent;
     document.getElementById(greenId).style.width = greenPercent + "%";
     document.getElementById(redId).style.width = redPercent + "%";
     });
     }
     setInterval(updateTimers, 1000);
     updateTimers(); // initial call
</script>
